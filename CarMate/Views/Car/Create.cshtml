@model CarMate.Cars

@{
    ViewBag.Title = "Create";
}



<div class="container">
    <h2>Создание автомобиля</h2>

    @using (Html.BeginForm("Create", "Car", FormMethod.Post, new {enctype = "multipart/form-data"}))
    {
        @Html.AntiForgeryToken()
        @Html.ValidationSummary(true)
        @Html.HiddenFor(x => x.UserId)

        <div class="form-horizontal">
            <div class="form-group col-md-12">
                @Html.LabelFor(model => model.CarModels.brandId, "Марка", htmlAttributes: new {@class = "control-label col-md-2"})
                <div class="col-md-3">
                    @Html.DropDownList("brandId", null, htmlAttributes: new {@class = "form-control", onchange = "GetModels(this)"}, optionLabel: "-выберите марку-")
                    @Html.ValidationMessageFor(model => model.CarModels.brandId, "", new {@class = "text-danger"})
                </div>
            </div>


            <div class="form-group col-md-12" id="car_model">
                @Html.Action("GetModels")
            </div>


            <div class="form-group col-md-12" id="car_modification">
                @Html.Action("GetModifications")
            </div>


            <div class="form-group col-md-12">
                @Html.LabelFor(model => model.Odometer, "Пробег", htmlAttributes: new {@class = "control-label col-md-2"})
                <div class="col-md-3">
                    @Html.TextBoxFor(cars => cars.Odometer, null, htmlAttributes: new {@class = "form-control"})
                    @Html.ValidationMessageFor(model => model.Odometer, "", new {@class = "text-danger"})
                </div>
            </div>

            <div class="form-group col-md-12">
                @Html.LabelFor(model => model.Tank, "Объем бака", htmlAttributes: new {@class = "control-label col-md-2"})
                <div class="col-md-3">
                    @Html.TextBoxFor(cars => cars.Tank, null, htmlAttributes: new {@class = "form-control"})
                    @Html.ValidationMessageFor(model => model.Tank, "", new {@class = "text-danger"})
                </div>
            </div>

            <div class="form-group col-md-12">
                @Html.LabelFor(model => model.Consumption, "Расход топлива", htmlAttributes: new {@class = "control-label col-md-2"})
                <div class="col-md-3">
                    @Html.TextBoxFor(cars => cars.Consumption, null, htmlAttributes: new {@class = "form-control"})
                    @Html.ValidationMessageFor(cars => cars.Consumption, "", new {@class = "text-danger"})
                </div>
            </div>

            <div class="form-group col-md-12">
                @Html.LabelFor(model => model.DateBuy, "Дата покупки", htmlAttributes: new {@class = "control-label col-md-2"})
                <div class="col-md-3">
                    @Html.TextBoxFor(model => model.DateBuy, htmlAttributes: new
                    {
                        @class = "form-control",
                        data_provide = "datepicker",
                        @Value = Model.DateBuy.Value.ToString("d")
                    })
                    @Html.ValidationMessageFor(model => model.DateBuy, "", new {@class = "text-danger"})
                </div>
            </div>
        </div>

        <div class="form-group col-md-12">
            @*<label class="control-label col-md-3" for="file">Выберите аватар автомобиля</label>*@
            @Html.LabelFor(model => model.ImgPath, "Фотография автомобиля", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                <input type="file" name="file" value="Выбрать картинку"/>
            </div>
        </div>

        <p>
            <input type="submit" value="Создать" class="btn btn-primary"/>
            @Html.ActionLink("Назад", "Index", "Car", null, new {@class = "btn btn-primary"})
        </p>
    }
</div> <!-- /class container-->




<script type="text/javascript">
    @* При изенении марки автомобиля подружаем модели *@
    function GetModels(id) {
        var brandId = id.value;
        $("#car_model").load('@(Url.Action("GetModels","Car"))', { "brandId": brandId });
        $("#car_modification").load('@(Url.Action("GetModifications","Car"))', { "modelId": 0 });
    }

    @* При изенении модеои автомобиля подружаем модификации *@
    function GetModifications(id) {
        var modelId = id.value;
        $("#car_modification").load('@(Url.Action("GetModifications","Car"))', { "modelId": modelId });
    }
</script>



@section scripts {
    @Scripts.Render("~/bundles/jqueryval")
    @Scripts.Render("~/Script/bootstrap-datepicker")
}